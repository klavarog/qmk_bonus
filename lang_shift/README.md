# Кастомные русская и английская раскладки

Данный модуль позволяет вам:
* Задавать кастомную английскую и русскую раскладку прямо в прошивке клавиатуры.
	* То есть вы сможете прямо внутри клавиатуры запрограммировать раскладку Диктор и Дворак для программистов.
* Быть полностью независимым от софта, то есть данная раскладка будет работать на любой системе, на абсолютно стандартных раскладках QWERTY и ЙЦУКЕН, и вам не нужно создавать и устанавливать свою раскладку в MKLC, например.
* Нажимать символы с шифтом, когда включён основной слой (можно симулировать раскладку Русская Машинопись).
* Нажимать символы без шифта, когда нажат шифт (можно симулировать ту часть Русской Машинописи, когда при зажатом шифте можно набирать цифры).
* Нажимать английские символы при включённой русской раскладке и наоборот. Это позволит вам создать раскладко-независимый способ набирать символы, и больше вам не придётся переключать язык чтобы набрать квадратные скобки,  `` ` `` из русского или `№` из английского.

# Как использовать?

В своём файле `keymap.c` в `enum`'е `custom_keycodes` подключаете файл `lang_shift/keycodes.h`. Сразу после него надо подключить файл `lang_shift/code.c`. А ещё надо задать способ переключения языка по умолчанию в переменной препроцессора `LANG_CHANGE_DEFAULT`, используя один из вариантов:

```
LANG_CHANGE_CAPS
LANG_CHANGE_ALT_SHIFT
LANG_CHANGE_CTRL_SHIFT
LANG_CHANGE_WIN_SPACE
```

Так же этими вариантами можно задавать способ переключения языка во время работы раскладки, модифицируя переменную `lang_current_change`, либо прямо на раскладке используя кейкоды:

```c
LA_CAPS, /* Задаёт переключение языка на Caps. */
LA_ALSH, /* Задаёт переключение языка на Alt + Shift. */
LA_CTSH, /* Задаёт переключение языка на Ctrl + Shift. */
LA_WISP, /* Задаёт переключение языка на Win + Space. */
```

Выглядеть это будет примерно так:

```c
enum custom_keycodes {
  RGB_SLD = ML_SAFE_RANGE,
  HSV_86_255_128,

  #include "lang_shift/keycodes.h"
};

#define LANG_CHANGE_DEFAULT LANG_CHANGE_CAPS
#include "lang_shift/code.c"
```

В своей функции `process_record_user` включаете код `lang_shift/process_record_user.c` следующим образом:

```c
bool process_record_user(uint16_t key, keyrecord_t *record) {
  #include "lang_shift/process_record_user.c"

  ...
}
```

Пишите свои раскладки следующим образом: 
* Первая раскладка без зажатого шифта находится в слое 0
* Первая раскладка при зажатом шифте находится в слое 1
* Аналогично вторая без шифта в 2 слое
* Аналогично вторая с шифтом в 3 слое

Причём в шифтовом слое для всех буквенных символов надо прописывать что будет нажат шифт. 

А для шифта и переключения языка используете кейкоды `SHF_1`, `LA_CHNG`, etc. Остальные смотите в файле `keycodes_lang_shift_processing.h`.

Для английского и русского языка используйте кейкоды с префиксами `EN_*`, `RU_*`, все их посмотреть можно в файле `keycodes_lang.h`.

Пример очень маленькой раскладки для клавиатуры с 4 кнопками

```c
const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
    //---------------------------------------------------------------------------
  [0] = LAYOUT(EN_AMPR, EN_W,    SHF_1,   LA_CHNG), // & w <Шифт> <Переключение языка>
  [1] = LAYOUT(EN_7,    EN_S_W,  _______, RU_NUME), // 7 W <Шифт> №
  [2] = LAYOUT(RU_7 ,   RU_JU,   SHF_3,   LA_CHNG), // 7 ю <Шифт> <Переключение языка>
  [3] = LAYOUT(RU_QUES, RU_S_JU, SHF_1,   EN_GRV ), // ? Ю <Шифт> `
};
```

Обратите внимание, что в шифтовом слое обязательно нужно прописывать что под `ю` находится `Ю` с зажатым шифтом.

# Рассинхрон

Это работает на основе того что клавиатура внутри хранит какой сейчас язык на компьютере. Затем при использовании кейкода `LA_CHNG` одновременно отправляется запрос на переключение языка в компьютер и язык переключается в клавиатуре. Но часто бывает так что в компьютере язык поменялся не из-за клавиатуры. Поэтому приходится вручную говорить клавиатуре об этом. Для этого есть кейкод `SYNC_LA`.

# Once Shift

Здесь так же представлены клавиши `SHF_1_O`, `SHF_3_O` (SHiFt Once), которые работают следующим образом:
* При зажатии применяют шифт только к одной следующей клавише, то есть он автоматически выключается после срабатывания на одной клавише.
* При одиночном нажатии тоже срабатывает для следующей клавиши, как One Shot Shift, но без таймаута.

Такая клавиша может пригодиться если вы печатаете с большой скоростью и вам сложно выдерживать время удержания шифта, и у вас получается что-то вроде "ПРивет" или "привет" (шифт отпустился раньше начала следующего слова).

# Плюсы и минусы по сравнению с заданием раскладки в ОС

**Плюсы:**
* Будет без всякой настройки компьютера работать, если уже установлены стандартные русский и английский языки. Вставил, нажал кнопку выбора метода переключения языка и всё.
* Будет работать без прав администратора.
* Будет работать на телефоне (на телефоне обычно очень сложно настраивать раскладку подключаемой физической клавиатуры, а на apple телефонах так вообще вроде невозможно).

**Минусы:**
* Невозможно посылать кейкоды, не существующие ни в русской, ни в английской раскладке, например `« » —`.
* Необходимость компилировать свою раскладку из кода, и вообще притрагиваться к коду. Некоторые люди предпочитают работать исключительно в графических конфигураторах.
